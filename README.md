# Пројекат из предмета Напредне технике програмирања

## Опис проблема
Неопходно је имплементирати систем који ће омогућавати пчеларима и љубитељима медних производа да рекламирају своја добра, претражују и коментаришу туђа и обавештавају остале кориснике о догађајима на којима ће презентовати своје медне производе.

## Архитектура система
Архитектура система базирана је на микросервисима. Сваки микросервис поседује засебну базу података (конкретно PostgreSQL) у којој чува податке којима само он управља. Сва комуникација између клијента и сервиса одвија се преко REST API-а. Микросервис за аутентификацију (Users Microservice) дефинише SECRET KEY који остали микросервиси користе за декодовање JWT токена и добављање података о пријављеном кориснику.

## Преглед микросервиса

###### Users Microservice
Django REST апликација која омогућава пријаву, регистрацију (уз верификацију email-а), измену профила корисника и коришћење уграђене Django Admin апликације за администрацију корисника (креирање, брисање, измена и преглед). Сервис приликом пријаве генерише JWT токен који ће корисник користити за аутентификацију на свим сервисима и дефинише SECRET KEY који ће остали сервиси користити за декодовање JWT tokena.

###### Advertisements Microservice
Golang REST апликација која омогућава аутентификованим корисницима креирање, брисање, измену, преглед, пагинацију и претрагу реклама медних производа. <b>Подаци којима је описана реклама су: </b>датум објаве, име производа који се рекламира, категорија производа, цена производа, опис производа и скуп слика.

###### Events Microservice
Golang REST апликација која омогућава аутентификованим корисницима креирање, брисање, измену, преглед и пагинацију догађаја на којима се презентује одређени медни производ. <b>Подаци којима је описан догађај је: </b>датум објаве, име догађаја, категорија догађаја (сајам, манифестација...), период и место одржавања, опис и скуп слика.

###### Comments Microservice
Django REST апликација која омогућава аутентификованим корисницима коментарисање рекламираних производа, брисање, преглед и пагинацију коментара и подкоментара, like и dislike.

## Клијенти система

###### Angular клијент
Главни клијент имплементиран у Angular језику који омогућава коришћење главних функционалности система. <b>Локација клијента је localhost:4200.</b>

###### Pharo клијент
Клијент који омогућава увид у аналитику система. Када администратор унутар Pharo окружења регистријe класу са методом која се налази путањи pharo-client/graphics.txt, добија могућност слања порука окружењу које ће му омогућавати графички приказ броја реклама, догађаја, коментара, like-ова и dislike-ова у одређеном временском интервалу. <b>Формат порука је CLASS_NAME entity ENTITY start START end END shape SHAPE</b>, где су елементи редом:
- CLASS_NAME представља назив под којим је администратор регистровао класу која ће имплементирати методу за графичке приказе.
- ENTITY представља ентитет чији се графички приказ жели увидети. Валидне вредности су "ads", "events", "comments", "likes" и "dislikes".
- START представља почетну годину од које се анализира статистика одабраног ентитета. Година мора бити четвороцифрен број.
- END представља крајњу годину до које се анализира статистика одабраног ентитета. Година мора бити четвороцифрен број, мора бити већа од почетне године и не сме бити већа од текуће године.
- SHAPE омогућава кориснику одабир приказа у виду plot-а (уколико се унесе "dots") и bar-ова (уколико се унесе "bars").

###### Django Admin апликација
Users Mikroservice омогућава коришћење уграђене Django Admin апликације која омогућава администрацију корисника - креирање, брисање, измена и преглед. <b>Локација клијента је localhost:8000/admin.</b>. Да би се апликација могла користити, неопходно је регистроваи Django супер корисника, користећи команду <b>python manage.py createsuperuser.</b>.

## Упутство за покретање
1. Локално креирати Postgre базе са називима <i>"users", "ads", "events" и "comments"</i>.
2. Користећи команду <i>python -m venv venv</i> креирати виртуелно окружење.
3. У виртуелно окружење инсталирати све библиотеке наведене у <i>requirements.txt</i> фајлу.
4. Активирати виртуелно окружење, позиционирати се у <i>user_service</i> и покренути команде <i>python manage.py migrate</i> и <i>python manage.py runserver</i>.
5. Активирати виртуелно окружење, позиционирати се у <i>comment_service</i> и покренути команде <i>python manage.py migrate</i> и <i>python manage.py runserver 8003</i>.
6. Покренути команде за преузимање неопходних Golang библиотека:
- go get -u -v github.com/dgrijalva/jwt-go
- go get -u -v github.com/gorilla/mux
- go get -u -v github.com/jinzhu/gorm
- go get -u -v github.com/lib/pq
- go get -u -v github.com/rs/cors
8. Позиционирати се у <i>ad_service</i> и покренути команду <i>go run .</i>.
9. Позиционирати се у <i>event_service</i> и покренути команду <i>go run .</i>.
10. Позиционирати се у <i>angular-client</i> и покренути команде <i>npm install</i> и <i>ng serve</i>.
11. Унутар Pharo окружења инсталирати библиотеке <i>Roassal2</i> и <i>NeoJSON</i>.
12. Унутар Pharo окружења регистровати/креирати класу у произвољном пакету са произвољним називом и унутар <i>Class опсега</i> новокреиране класе регистровати методу која се налази на путањи <i>pharo-client/graphics.txt</i>.
13. За коришћење Angular клијента у URL претраживача унети путању <i>localhost:4200</i>.
14. За коришћење Pharo клијента отворити <i>Playground Pharo окружења</i> и слати претходно описане поруке.
15. За коришћење Django Admin апликације у URL претраживача унети путању <i>localhost:8000/admin</i>.

## Покретање тестова

###### Покретање јединичних тестова микросервиса написаних у Python-у
Активирати виртулено окружење, позиционирати се у директоријум микросервиса и покренути команду <i>python manage.py test</i>.

###### Покретање јединичних тестова микросервиса написаних у Golang-у
Позиционирати се у директоријум микросервиса и покренути команду <i>go test -v</i>.
